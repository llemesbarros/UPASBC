<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAJ6TrAFy+8QCC0vgA7+/vAC6n7ACE0/gAS2RuAKbU5QDAwMAAv+3+ACek6gApoeYAAAAAAAAAAAAAAAAARERERERERABEREREREREAEREREREREQAREREeIRERABJmZSohUREAERERKolVEQAREREozUVRABJmZRDNlFUAEREREQzZRUAREREREM2W1BJmZmZRDNlxUREREREQzZVREREREREMzVJmZmZmURDM0REREREREQzRERERERERAMAAwAAAAMAAAADAAAAAwAAAAMAAAADAAAAAwAAAAMAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAA"
        rel="icon" type="image/x-icon" />

  <style>
    body{font-family:sans-serif;}
    header img{margin-right:10px;}
    th{padding-top:10px;}
    .paciente td{width:100%; border-bottom:1px}
    td input[type=text]{width:100%; height:28px; text-transform:uppercase; border-width:0 0 1px 0; font:inherit}
    #data{height:28px; border-width:0 0 1px 0; text-align:center; font:inherit}

    /* Quill editor height (screen) */
    #texto{height: 640px;}

    #medicamentos,button{padding:5px;}
    #page1{page-break-after: always;}

    /* ====== QUILL CONTENT: bigger font ====== */
    .ql-editor{
      font-size: 16px;
      line-height: 1.5;
    }
    
    /* Garante que o SoftBreak (Shift+Enter) seja visível e ocupe espaço */
    .ql-editor br { display: inline; }

    /* ====== Ordered list styling inside editor ====== */
    .ql-editor ol{
      padding-left: 28px;
      margin: 0;
    }
    .ql-editor li{
      margin: 0 0 12px 0;
      padding-bottom: 6px;
      border-bottom: 1px dashed #bbb;
    }
    .ql-editor li:last-child{
      margin-bottom: 0;
      border-bottom: 0;
    }
    .ql-editor li::marker{
      font-weight: bold;
    }

    /* Screen-only */
    @media screen {
      .printonly{display:none;}
      #pagenum{display:none;}
    }

    /* Print */
    @media print {
      @page { size: A4 portrait; margin: 10mm; }
      html, body { margin: 0; padding: 0; }

      .noprint, .ql-toolbar { display:none !important; }

      #pagenum{
        display:block !important;
        position: relative;
        font-size: 14px;
        text-align: right;
        margin: 0 0 4mm 0;
        padding: 0;
      }

      #page1 { break-after: page; page-break-after: always; }

      #texto{
        border: 0 !important;
        height: 160mm; /* ajuste fino: 155–165mm */
        overflow: hidden;
      }

      .ql-editor{
        font-size: 17px;
        line-height: 1.45;
      }

      h5 { break-inside: avoid; page-break-inside: avoid; }

      body.duasvias #page1 #pagenum span::after { content:"1ª VIA FARMÁCIA"; }
      body.duasvias #page2 #pagenum span::after { content:"2ª VIA PACIENTE"; }
      body:not(.duasvias) #page1 #pagenum span::after { content:"VIA ÚNICA"; }
    }

    /* =========================
       FONTS for Quill (Font picker)
       ========================= */
    /* Importando Roboto e Playwrite AT (Österreich) */
    @import url('https://fonts.googleapis.com/css2?family=Playwrite+AT:wght@100..400&family=Roboto:wght@400;700&display=swap');

    .ql-font-sans-serif { font-family: sans-serif; }
    .ql-font-serif { font-family: serif; }
    .ql-font-monospace { font-family: monospace; }
    .ql-font-roboto { font-family: "Roboto", sans-serif; }
    /* Nova classe para Playwrite */
    .ql-font-playwrite { font-family: "Playwrite AT", cursive; }

    /* Rótulos do Dropdown */
    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="sans-serif"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="sans-serif"]::before { content: "Sans"; }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="serif"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="serif"]::before { content: "Serif"; }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="monospace"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="monospace"]::before { content: "Mono"; }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="roboto"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="roboto"]::before { content: "Roboto"; }

    /* Rótulo visual para Playwrite */
    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="playwrite"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="playwrite"]::before { content: "Playwrite"; }
  </style>

  <script src="medicamentos.json"></script>
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet">

  <script>
    let quill = null;

    function addMedicamento(selectEl) {
      if (!quill) return;

      const opt = selectEl.selectedOptions && selectEl.selectedOptions[0];
      if (!opt || opt.value === "0") return;

      const desc = opt.dataset.desc || "";
      const pos  = opt.dataset.pos  || "";
      if (!desc) return;

      const index = Math.max(0, quill.getLength() - 1);

      // 1. Insere o NOME (Negrito)
